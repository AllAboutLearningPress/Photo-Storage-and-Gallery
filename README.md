# Photo-Storage-and-Gallery

Description.

## Getting started

Project requires [node >=10.22.1](https://nodejs.org/en/) to be installed on your computer. You'll also need git installed (don't forget to add it in your `PATH`): https://git-scm.com/downloads

Download repository, install project dependencies running `npm i` in the command line inside the root folder. Then you can: 
- `npm run start` to start project in dev mode; 
- `npm run build` to build a project in production mode;
- read ahead for full description of npm scripts.

## npm scripts

There are some npm scripts for developing, building, debugging and other tasks.

### `npm run start`

Starts the project in development mode. You need to start a PHP server inside the folder with built project (`./dist`). 

### `npm run clean`

Deletes folder with built project (`./dist`)

### `npm run build`

Build project in production mode.

### `npm run build:analyze`

Same as `npm run build`, but also analyzing final build with [webpack-bundle-analyzer](https://github.com/webpack-contrib/webpack-bundle-analyzer)

### `npm run debug`
Debug webpack node process, see: https://nodejs.org/en/docs/guides/debugging-getting-started/

### `npm run debug:dev`
Same as `npm run debug`, but for development build

### `npm run debug:prod`
Same as `npm run debug`, but for production build

### `npm run lint:js`

Lint source JS using `eslint` with [--fix](https://eslint.org/docs/2.13.1/user-guide/command-line-interface#options)

## Structure

All configuration files are contained in the project root. Other folders are:

- `./build-utils`: webpack build utilities and presets, see [Configuration section](#configuration) for further details
- `./src`: source code for the project
- `./dist`: location of the final build

## CSS

CSS is located in `./src/css` folder. For CSS processing project uses [SCSS](https://sass-lang.com/) and [PostCSS](https://postcss.org/). 

CSS is imported in separate webpack entry, located at `./src/js/styles.css.js`

For the PostCSS config see `postcss.config.js`.

## JavaScript

JavaScript is located in `./src/js` folder.

## Images

Images gets optimised automatically.


## Manifest

Production build generates a `manifest.json` file (using [webpack-manifest-plugin](https://github.com/shellscape/webpack-manifest-plugin)) inside a `./dist` folder, containing the list of all relevant file paths and their respective hashed paths, to allow a server to refer to a proper files generated by webpack build (relevant for JS/CSS bundles which include hashes in a filename).

## Configuration

Configuration files are located in the project root

### Browser support

Project uses [browserlist](https://github.com/browserslist/browserslist) to define supported browsers, see `.browserslistrc`.

### Code linting

The basic code style is define in `.editorconfig`, make sure your IDE or code editor supports it. See: https://editorconfig.org/.

Then there is linting JS with [ESlint](https://eslint.org/) ([airbnb style guide](https://github.com/airbnb/javascript/)). 
See `.eslintrc.js` for details.

[Prettier](https://prettier.io/) is used to make code looks consistent, see `.prettierrc`.

### Code processing

JavaScript is processed with [Babel](https://babeljs.io/), but usage of newest language features should remain conservative to [avoid bloat in the final build](https://medium.com/@WebReflection/avoiding-babels-production-bloat-d53eea2e1cbf). See `babel.config.js`.

CSS is processed with [PostCSS](https://postcss.org/) (after it gets transpiled from [SCSS](https://sass-lang.com/)), see `postcss.config.js`.

### Webpack configuration

First, some links: 

- https://webpack.js.org/configuration/
- https://survivejs.com/webpack/foreword/

Webpack is configured via multiple composed configs (base, development and production) and optional presets, see https://github.com/survivejs/webpack-merge.
Base config is located in `webpack.config.js`.  Development and production config, as well as presets, are located in `./build-utils` folder, see `./build-utils/webpack.development.js`, `./build-utils/webpack.development.js` and `./build-utils/presets`.
The file with shared settings (mainly file paths) is also used by different webpack configs, see `./build-utils/settings.js`.

Presets are modular features which gets merged into final webpack config as needed via npm scripts and `env` variable, see https://frontendmasters.com/courses/webpack-fundamentals/implementing-presets/.
With a help of `./build-utils/loadPresets.js` utility (which is used in a base webpack config) we can write modular presets inside `./build-utils/presets` with a following file format: `webpack.presetname.js`. 
Then we can use them in npm scripts as follows: `"build:analyze": "npm run build -- --env.presets analyze"`. `-- --env.presets analyze` appends arguments to the `build` script, so we can add functionality to the basic `build` task, and eventually get `./build-utils/presets/webpack.analyze.js` merged into the final config.

### git

See `.gitattributes` and `.gitignore`.
